{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8171821a-34ad-4f39-a810-f06c586b5e8d",
   "metadata": {},
   "source": [
    "# A potential barrier"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "17e7b6aa-20b3-4bc4-8a75-8ddc898b1c91",
   "metadata": {},
   "source": [
    "The free particle with $E_{\\mathrm{pot}} = 0$ as we discussed it previously might propagate in $+x$ direction and enter a region with a different potential $\\phi \\left( x \\ge 0 \\right) =\\phi_0 > 0$. Thus, the particle experiences a shift in its potential energy from $E_{\\mathrm{pot}} = 0$ for $x < 0$ to $E_{\\mathrm{pot}} = E_0$ for $x \\ge 0$. This scenario is similar to a light wave at the air-glass interface. \n",
    "\n",
    "In order to solve the Schrödinger equation for this problem, we split the space $-\\infty < x < \\infty$ into two regions. In region 1, where $E_{\\mathrm{pot}} = 0$, we can state the general solution for the one-dimensional stationary Schrödinger equation as \n",
    "\n",
    "$$\n",
    "- \\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) + E_{\\mathrm{pot}} \\psi\\left( x \\right) = E \\psi \\left( x \\right) \\mathrm{.}\n",
    "$$\n",
    "\n",
    "Because $E_{\\mathrm{pot}} = 0$ and $E = E_{\\mathrm{kin}} + E_{\\mathrm{pot}}$, we can simplify $E = E_{\\mathrm{kin}} =  p^2/\\left( 2 m \\right) = \\hbar^2 k^2 / 2 m$ and get \n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "- \\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) & = & \\frac{\\hbar^2 k^2}{2 m} \\psi \\left( x \\right)\\\\\n",
    "\\rightarrow \\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) & = & - k^2 \\psi \\left( x \\right) \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "The general solution of $\\psi\\left( x \\right)$ has the shape\n",
    "\n",
    "$$\n",
    "\\psi\\left( x \\right) = A \\cdot \\mathrm{e}^{+i k x} + B \\cdot \\mathrm{e}^{-i k x}\n",
    "$$\n",
    "\n",
    "and the time-dependent solution for the wave function\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi \\left( x,t \\right) & = & \\psi \\left( x \\right) \\cdot \\mathrm{e}^{-i \\omega t}\\\\\n",
    "{} & = & A \\cdot \\mathrm{e}^{i \\left( k x - \\omega t \\right)} + B \\cdot \\mathrm{e}^{-i \\left( k x + \\omega t \\right)}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "is a superposition of a plane wave propagating in $+x$ direction and a plane wave propagating in $-x$ direction. Here, the wave with coefficient $A$ in propagation along $+x$ direction and the wave with the coefficient $B$ is propagation along the $-x$ direction. The coefficients $A$ and $B$ are the amplitudes of both waves and are determined on the basis of boundary conditions. If we now concentrate again on our potantial barrier, we can state for the position-dependent solution in region 1\n",
    "\n",
    "$$\n",
    "\\psi_{\\mathrm{1}} \\left( x \\right) = A \\cdot \\mathrm{e}^{+i k x} + B \\cdot \\mathrm{e}^{-i k x} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "For region 2 where $E_{\\mathrm{pot}} = E_0$ we can state the Schrödinger equation as follows\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "- \\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) + E_0 \\psi\\left( x \\right) & = & E \\psi \\left( x \\right) \\\\\n",
    "\\rightarrow \\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) - \\frac{2m}{\\hbar^2} \\left(E_0 - E \\right) \\psi\\left( x \\right) & = & 0\\\\\n",
    "\\frac{\\partial^2}{\\partial x^2} \\psi\\left( x \\right) - \\alpha^2 \\psi\\left( x \\right) & = & 0\\mathrm{,}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "with $\\alpha = \\sqrt{2m\\left(E_0 - E \\right)}/\\hbar$. The solution for region 2 then reads as\n",
    "\n",
    "$$\n",
    "\\psi_{\\mathrm{2}} \\left( x \\right) = C \\cdot \\mathrm{e}^{+\\alpha x} + D \\cdot \\mathrm{e}^{-\\alpha x}\n",
    "$$\n",
    "\n",
    "and the general solution for the position-dependent factor of the one-dimensional stationary Schrödinger equation reads as\n",
    "\n",
    "$$\n",
    "\\psi \\left( x \\right) =\n",
    "    \\begin{cases}\n",
    "      \\psi_{\\mathrm{1}} \\left( x \\right) & \\text{, if $x < 0$}\\\\\n",
    "      \\psi_{\\mathrm{2}} \\left( x \\right) & \\text{, if $x \\ge 0$}\n",
    "    \\end{cases} \\mathrm{.}       \n",
    "$$\n",
    "\n",
    "The general solution does represent a solution of the Schrödinger equation for the whole space $- \\infty < x < \\infty$ if and only if $\\psi \\left( x \\right)$ is continuously differentiable over the whole space. Otherwise the second derivative $ \\partial^2 \\psi\\left( x \\right) / \\partial x^2$ in the Schrödinger equation will be undefined. From this prerequisite the boundary conditions at $x = 0$ directly follow,\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_{\\mathrm{1}} \\left( x = 0 \\right) & = & \\psi_{\\mathrm{2}} \\left( x = 0 \\right)\\\\\n",
    "\\rightarrow A + B & = & C +D\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\frac{\\partial}{\\partial x} \\psi_{\\mathrm{1}} \\left( x = 0 \\right) & = &  \\frac{\\partial}{\\partial x} \\psi_{\\mathrm{2}} \\left( x = 0 \\right)\\\\\n",
    "\\rightarrow i k \\left(A - B \\right) & = & \\alpha \\left( C - D \\right) \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65b1c5a6-4738-43e7-94c0-d6bfa53635c6",
   "metadata": {},
   "source": [
    "## The case $0 < E < E_0$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9d97cf38-f426-4da8-af62-81f24dab2c13",
   "metadata": {},
   "source": [
    "In the case $E<E_0$, $\\alpha$ is a real number. Moreover the coefficient $C$ has to be $0$, otherwise $\\psi_{\\mathrm{2}}$ will approach $+\\infty$ for $x \\longrightarrow +\\infty$. From the boundary conditions we get\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "B & = & \\frac{i k + \\alpha}{i k - \\alpha} A\\\\\n",
    "D & = & \\frac{2 i k}{i k - \\alpha} A\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and thus the wave function in region 1 ($x < 0$) reads as\n",
    "\n",
    "$$\n",
    "\\psi_{\\mathrm{1}} \\left( x \\right) = A \\left( \\mathrm{e}^{+i k x} + \\frac{i k + \\alpha}{i k - \\alpha} \\mathrm{e}^{-i k x} \\right)\\mathrm{.}\n",
    "$$\n",
    "\n",
    "Because we do know the wave function and its amplitudes, we can calculate the **reflection coefficient** as the ratio of the squared reflected and initial waves,\n",
    "\n",
    "$$\n",
    "R = \\frac{\\left| B \\cdot \\mathrm{e}^{-i k x} \\right|^2}{\\left| A \\cdot \\mathrm{e}^{+i k x} \\right|^2} = \\frac{\\left| B \\right|^2}{\\left| A \\right|^2} = \\frac{\\left| i k + \\alpha \\right|^2}{\\left| i k - \\alpha \\right|^2} = 1 \\mathrm{.}\n",
    "$$\n",
    "\n",
    "From this result it is evedent that in the case $E < E_0$ every particle is reflected at the barrier as to be expected in the framework of classical mechanics. However, the particles do not change their direction of propagation diretly at the edge of the barrier ($x = 0$). Instead, they are able to intrude into region 2 ($x \\ge 0$) to some extend, even though their energy is not sufficient ( if discussed in the classical framework).\n",
    "\n",
    "The probibility density $P \\left( x \\right)$ to find a particle at the position $x$ (with $x > 0$) then is given through\n",
    "\n",
    "$$\n",
    "P \\left( x \\right) = \\left| \\psi_2 \\left( x \\right) \\right|^2 = \\left| D \\cdot \\mathrm{e}^{- \\alpha x} \\right|^2 = \\frac{4 k^2}{\\alpha^2 + k^2} \\mathrm{e}^{-2 \\alpha x} = \\frac{4 k^2}{k_0^2} \\mathrm{e}^{-2 \\alpha x} \\mathrm{,}\n",
    "$$\n",
    "\n",
    "where $k^2 = 2 m E / \\hbar^2$ and $k_0^2 = 2 m E_0 / \\hbar^2$. We see, at a depth of penetration of $x = 1/\\left(2\\alpha\\right)$ the propability density to find the particle at this position is decreased about the fractor $1/\\mathrm{e}$ compared to the propability density at $x=0$. This phenomenon we allready know as evanescent waves during total internal reflection.\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L25_potential_barrier_1.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: A wave with a kinetic energy $E_{\\mathrm{kin}}$ approaches a potential barrier $E_0$ with $E_0 > E_{\\mathrm{kin}}$. The wave is completely reflacted (amplitudes $\\left|A\\right|$ = $\\left|B\\right|$), but intrudes the barrier where the amplitude decays exponentially.** \n",
    "  </figcaption>\n",
    "</figure>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "46a45720-0503-4657-a5a3-5752ee5ff95d",
   "metadata": {},
   "source": [
    "## The case $0 < E_0 < E$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "513e8075-e97c-44aa-b554-eb4452281864",
   "metadata": {},
   "source": [
    "In this case the kinetic energy is greater than the shift in the potential energy.  In the framework of classical mechanics, every particle is allowed to enter region 2 ($x>0$) and to propagate there, but with a reduced velocity due to their decreased kinetic energy ($E_{\\mathrm{kin}} = E - E_0$).\n",
    "\n",
    "In the framwork of matter waves the parameter $\\alpha$ now is an imaginary number. Therefore, we introduce a real number,\n",
    "\n",
    "$$\n",
    "\\kappa = i \\alpha = \\frac{\\sqrt{2 m \\left( E - E_0 \\right)}}{\\hbar} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "The solution for the position-dependent amplitude $\\psi_2 \\left( x \\right)$ in region 2 then reads as\n",
    "\n",
    "$$\n",
    "\\psi_2 \\left( x \\right) = C \\cdot \\mathrm{e}^{-i \\kappa x} + D \\cdot \\mathrm{e}^{+i \\kappa x} \\mathrm{,}\n",
    "$$\n",
    "\n",
    "whereas the solution $\\psi_1 \\left( x \\right)$ for the stationary equation in region 1 remains the same as stated above.\n",
    "\n",
    "As in the case of the first example, we state the boundary conditions at $x = 0$ as\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_{\\mathrm{1}} \\left( x = 0 \\right) & = & \\psi_{\\mathrm{2}} \\left( x = 0 \\right)\\\\\n",
    "\\rightarrow A + B & = & C +D\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\frac{\\partial}{\\partial x} \\psi_{\\mathrm{1}} \\left( x = 0 \\right) & = &  \\frac{\\partial}{\\partial x} \\psi_{\\mathrm{2}} \\left( x = 0 \\right)\\\\\n",
    "\\rightarrow i k \\left(A - B \\right) & = & i \\kappa \\left( -C + D \\right) \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "\n",
    "Furthermore, in region 2 there is no wave propagating along the $-x$ direction since there is no boundary located in region 2 in order to reflect the wave. Thus, we can set $C = 0$. From the boundary conditions it follows\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "B & = & \\frac{k - \\kappa}{k + \\kappa} A\\\\\n",
    "D & = & \\frac{2}{k + \\kappa} A\\\\\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and the wave functions read as\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_{\\mathrm{1}} \\left( x \\right) & = & A \\left( \\mathrm{e}^{+i k x} + \\frac{k - \\kappa}{ k + \\kappa} \\mathrm{e}^{-i k x} \\right)\\\\\n",
    "\\psi_{\\mathrm{2}} \\left( x \\right) & = & A \\frac{2 k}{ k + \\kappa} \\mathrm{e}^{+i \\kappa x} \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "For the reflection coefficient it follows \n",
    "\n",
    "$$\n",
    "R = \\frac{\\left| B \\right|^2}{\\left| A \\right|^2} = \\frac{\\left| k - \\kappa \\right|^2}{\\left| k + \\kappa \\right|^2}\n",
    "$$\n",
    "\n",
    "and we see, even though the kinetic energy of our pairticle is sufficient enough to overcome the potential barrier, a part of the wave is reflected. Furthermore, since the wavenumber is directly connected to the refrective index $k = n_1 \\cdot k_0$ and $\\kappa = n_2 \\cdot k_0$, we can immediately calculate the reflectance,\n",
    "\n",
    "$$\n",
    "R = \\frac{\\left| n_1 - n_2 \\right|^2}{\\left| n_1 + n_2 \\right|^2}\\mathrm{.}\n",
    "$$\n",
    "\n",
    "In order to calculate the transmission coefficient, or how many particles pass a unit area at $x=x_0>0$ per time devided through how many incident particles pass a unit area at $x=-x_0<0$ per time, we have to bear in mind the different propagation velocities in region 1 and 2. The ratio of the velocities is governed by the ratio of the wavenumbers\n",
    "\n",
    "$$\n",
    "\\frac{v_2}{v_1} = \\frac{\\lambda_2}{\\lambda_1} = \\frac{k}{\\kappa}  \\mathrm{.}\n",
    "$$\n",
    "\n",
    "The transmission coefficient then reads as\n",
    "\n",
    "$$\n",
    "T = \\frac{v_1 \\cdot \\left| D \\right|^2}{v_2 \\cdot \\left| A \\right|^2} = \\frac{4 \\kappa k}{\\left( k + \\kappa \\right)^2}\\mathrm{.}\n",
    "$$\n",
    "\n",
    "Moreover, it is evident that \n",
    "\n",
    "$$\n",
    "R + T = 1 \\mathrm{,}\n",
    "$$\n",
    "\n",
    "which represents the conservation of the number of particles. Please note, for the limiting case $E = E_0$ every exponent becomes $0$ ($\\alpha = 0$ as well as $\\kappa = 0$) and the reflection coefficient becomes $R=1$.\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L25_potential_barrier_2.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: A wave with a kinetic energy $E_{\\mathrm{kin}}$ approaches potential barrier $E_0$ with $E_{\\mathrm{kin}} > E_0 $. The wave is partially reflected and partially transmitted.** \n",
    "  </figcaption>\n",
    "</figure>"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "41d5c882-1748-4fdb-b400-de0ceef1fd2d",
   "metadata": {},
   "source": [
    "## The case $E_0 < 0 < E$"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "38cbdbca-8ac7-495e-8b62-29695e32ee82",
   "metadata": {},
   "source": [
    "In this case the potential barrier is negative ($E_0 < 0$). In the framework of classical mechanics, every particle is allowed to the region of teh barrier ($x>0$) and to propagate there with an increased velocity due to their increased kinetic energy ($E_{\\mathrm{kin}} = E - E_0$). This situation is analoque to the transition of a light wave from a medium with a higher index of refraction into a medium with a lower index.\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L25_potential_barrier_3.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: A wave with a kinetic energy of $E_{\\mathrm{kin}}$ approaches a potential step with $E_0 < 0$.** \n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "As in the cases examples above we again split the our space $-\\infty < x < +\\infty$ into two regions, namely region 1 with $x < 0$ and region 2 with $x \\ge 0$. Furthermore, we can allready state the general solutions for the position-dependent amplitude $\\psi \\left( x \\right) in both regions, namely \n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_1 \\left( x \\right) = A \\cdot \\mathrm{e}^{+i k x} + B \\cdot \\mathrm{e}^{-i k x}\\\\\n",
    "\\psi_2 \\left( x \\right) = C \\cdot \\mathrm{e}^{-i \\kappa x} + D \\cdot \\mathrm{e}^{+i \\kappa x} \\mathrm{,}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "where \n",
    "\n",
    "$$\n",
    "\\kappa = i \\alpha = \\frac{\\sqrt{2 m \\left( E - E_0 \\right)}}{\\hbar} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "From the boundarey conditions\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_1 \\left( x = 0 \\right) & = & \\psi_2 \\left( x = 0 \\right) \\; \\; \\mathrm{and}\\\\\n",
    "\\frac{\\partial}{\\partial x} \\psi_1 \\left( x = 0 \\right) & = &  \\frac{\\partial}{\\partial x} \\psi_2 \\left( x = 0 \\right)\\\\\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "we get\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "A + B & = & C +D \\; \\; \\mathrm{and}\\\\\n",
    "i k \\left(A - B \\right) & = & i \\kappa \\left( -C + D \\right) \\mathrm{,}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "respectively. In addition, we set $C = 0$, because therre is no wave to be expected propagating along the $-x$ direction in region 2. As a consequence we can determine the coefficients as\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "B & = & \\frac{k - \\kappa}{k + \\kappa} A \\; \\; \\mathrm{and}\\\\\n",
    "D & = & \\frac{2 k}{k + \\kappa} A \\mathrm{,}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "being identical to the above case for $0 < E_0 < E$. As a consequence the reflection coefficient,\n",
    "\n",
    "$$\n",
    "R = \\frac{\\left| B \\right|^2}{\\left| A \\right|^2} = \\frac{\\left| k - \\kappa \\right|^2}{\\left| k + \\kappa \\right|^2}\n",
    "$$\n",
    "\n",
    "and transmission coefficient\n",
    "\n",
    "$$\n",
    "T = \\frac{4 \\kappa k}{\\left( k + \\kappa \\right)^2}\\mathrm{.}\n",
    "$$\n",
    "\n",
    "obey the identical equations. However, bear in mind that $E_0 < 0$ and thus $\\kappa$ is real number with\n",
    "\n",
    "\n",
    "$$\n",
    "\\frac{\\kappa}{k} = \\frac{\\sqrt{E + \\left| E_0 \\right|}}{\\sqrt{E}} = \\sqrt{1 + \\frac{\\left| E_0 \\right|}{E}}\n",
    "$$\n",
    "\n",
    "and $\\kappa \\ge k$. In addition, the transmission coefficient is *non-zero* for e wide range of the relative energy $E/E_0$ which is in stark contradiction to classical mechanics.\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L26_potential_barrier_r_t_5_1.png\" width=\"45%\">\n",
    "      <img src=\"img/L26_potential_barrier_r_t_5_2.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: (left) The transmission coefficient $T$ and reflection coefficient $R$ in dependence of the particle's relative energy $E / E_0$ in the case of a negative potential step $E_0 < 0$. (right) $1 - T$ in a logarithmic scale. Note that $T$ is non-zero for a wide range of energy.**\n",
    "  </figcaption>\n",
    "</figure"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "84cc6896-2080-45e5-b641-84c1d687bb62",
   "metadata": {},
   "source": [
    "## The tunnel effect or quantum tunnelling"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36fe0484-6faa-4e1f-aae2-155e04af15cb",
   "metadata": {},
   "source": [
    "In order to discuss the tunnel effect we construct a potential barrier with a finite width $\\Delta x = a$. Thus, for the regions $x < 0$ and $x > a$ the potential energy vanishes $E_{\\mathrm{pot}} = 0$, whereas for $0 \\le x \\le a$ the potential energy exhibit $E_{\\mathrm{pot}} = E_0$. Moreover, now with split the definition range $-\\infty < x < +\\infty$ into three region, namely\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\mathrm{Region \\, 1} & \\; & x < 0\\\\\n",
    "\\mathrm{Region \\, 2} & \\; & 0 \\le x \\le a\\\\\n",
    "\\mathrm{Region \\, 3} & \\; & a < x \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "For every region we state the genernal solution of the position-dependent amplitude $\\psi \\left( x \\right)$ of the wave function as we have derived them previously\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_1 & = & A \\mathrm{e}^{+i k x} + B \\mathrm{e}^{-i k x}\\\\\n",
    "\\psi_2 & = & C \\mathrm{e}^{\\alpha x} + D \\mathrm{e}^{-\\alpha x}\\\\\n",
    "\\psi_3 & = & A^{\\prime} \\mathrm{e}^{+i k x} + B^{\\prime} \\mathrm{e}^{-i k x}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and calculate teh boundary conditions at at $x = 0$,\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_1 \\left( x = 0 \\right) & = & \\psi_2 \\left( x = 0 \\right)\\\\\n",
    "\\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_1 \\left( x = 0 \\right) & = & \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_2 \\left( x = 0 \\right) \\mathrm{,}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and in additon at $x = a$,\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "\\psi_2 \\left( x = a \\right) & = & \\psi_3 \\left( x = a \\right)\\\\\n",
    "\\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_2 \\left( x = a \\right) & = & \\frac{\\mathrm{d}}{\\mathrm{d}x} \\psi_3 \\left( x = a \\right) \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "In addition there is no potentially reflecting interface in region 3 at a position $x > a$. Thus, we can exclude a wave propagating along $-x$ direction and set \n",
    "\n",
    "$$\n",
    "B^{\\prime} = 0 \\mathrm{.}\n",
    "$$\n",
    "\n",
    "From the previous cases we know that at the first boundary ($x=0$) the incident wave propagating along $+x$ direction in region 1 is (partially) reflected. On the basis of the propagation directions we can explicitly write down the incident wave as $\\psi_{inc} = A \\cdot \\mathrm{e}^{+i k x}$, the reflected wave as $\\psi_{ref} = B \\cdot \\mathrm{e}^{-i k x}$, and the wave transmitted through the barrier propagating along $+x$ direction in region 3 as $\\psi_{trans} = A^{\\prime} \\cdot \\mathrm{e}^{+i k x}$. In order to calculate the **transmission probability** or **tunneling probability** we have to know how much intensity from the incident wave reaches the backside of the barrier, \n",
    "\n",
    "$$\n",
    "T \\left(E, a\\right) = \\frac{\\left| \\psi_{trans} \\right|^2}{\\left| \\psi_{inc} \\right|^2} = \\frac{\\left| A^{\\prime} \\right|^2}{\\left| A \\right|^2} = \\left| \\frac{A^{\\prime}}{A} \\right|^2  \\mathrm{.}\n",
    "$$\n",
    "\n",
    "Please not, the particular values for the speed of propagation at either side of the barrier are identical and will result in a ratio of $1$. \n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L25_potential_barrier_4_tunneleffect.png\" width=\"75%\">\n",
    "  <figcaption>**Fig.: A wave with a kinetic energy of $E_{\\mathrm{kin}}$ approaches a potential step with $E_{\\mathrm{kin}} < E_0$. Since the width of the potential is finite, the wave might **tunnel** through the barrier. At the other side amplitude is reduced which reflects a reduced propability density. The energy, however, is conserved.** \n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "From the boundary conditions we get\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "A + B & = & C +D\\\\\n",
    "C \\mathrm{e}^{+ \\alpha a} + D \\mathrm{e}^{- \\alpha a} & = & A^{\\prime} \\mathrm{e}^{+ i k}\\\\\n",
    "i k \\left( A - B \\right) & = & \\alpha \\left( C  - D \\right)\\\\\n",
    "\\alpha \\left( C \\mathrm{e}^{+ \\alpha a} - D \\mathrm{e}^{- \\alpha a} \\right) & = & i k A^{\\prime} \\mathrm{e}^{+ i k a}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "which means we four equation in order to determine five constants. However, we are not exactly seeking for the parameters, but rahter for a ratio of those like $A^{\\prime}/A$. Thus, we multiply each equation from the boundary conditions with the factor $1/A$ and have now four equtaions in order to determine the four new constants. The ectual algabra in porder to isolate $A^{\\prime}/A$ is quite lengthy. Therefore, we only state the result here,\n",
    "\n",
    "$$\n",
    "\\frac{A^{\\prime}}{A} = \\frac{\\mathrm{e}^{-i k \\cdot a}}{\\cosh \\left( \\alpha \\cdot a\\right) + \\frac{i}{2} \\left(\\frac{\\alpha}{k} - \\frac{k}{\\alpha}\\right) \\sinh \\left( \\alpha \\cdot a \\right)} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "We now calculate the transmission coeficient $T = \\left| A^{\\prime}/A \\right|^2$ and get\n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "T & = & \\left| \\frac{A^{\\prime}}{A} \\right|^2\\\\\n",
    "{} & = & \\frac{1}{\\cosh^2 \\left( \\alpha \\cdot a\\right) + \\frac{1}{4} \\left(\\frac{\\alpha}{k} - \\frac{k}{\\alpha}\\right)^2 \\sinh^2 \\left( \\alpha \\cdot a \\right)}\\\\\n",
    "{} & = & \\frac{1 - \\frac{E}{E_0}}{1- \\frac{E}{E_0} + \\frac{1}{4}\\frac{E_0}{E} \\sinh^2 \\left( \\alpha \\cdot a \\right)} \\mathrm{.}\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "For a sufficient wide barrier ($\\alpha \\cdot a \\gg 1$), we can simplify approximate the transmission probability through\n",
    "\n",
    "$$\n",
    "T \\approx 16 \\frac{E}{E_0^2} \\left(E_0 - E \\right) \\cdot \\mathrm{e}^{-2 \\alpha a} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "It is evident that the tunneling probability strongly depends on the width of the barrier ($a$) but also its height ($E_0$) and the difference between the barrier height and the particle's energy. If we, for example, assume a particle with an energy of $E = E_0 / 2$ and a barrier width of half the de Broglie wavelength $a = \\lambda/2$, we get $\\alpha \\cdot a = \\pi$ and $T = 0.5 / \\left( 0.5 \\left( 1 + \\sinh^2 \\left( \\pi \\right) \\right) \\right) = 7 \\cdot 10^{-3}$. Thus, the probability for a particle to tunnel through the barier is $0.7\\%$. In the framework of classical mechanics, instead, no particle with $E < E_0$ is allowed to reach the space behind the barrier and thus $T_{\\mathrm{classic}} = 0$. In addition, if the energy of a partcile is sufficient large like $E > E_0$, the particle is allowed to overcome the barrier ans thus $T_{\\mathrm{classic}} = 1$.\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L26_tunneleffect.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: The transmission coefficient $T$ and reflection coefficient $R = 1-T$ in dependence of the particle's relative energy $E / E_0$ in the case of a rectangular potential barrier with a width of $a = 3 \\hbar / \\sqrt{2 m E_0}$. Note the oscillations even for $E / E_0 > 1$.**\n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "While having a closer look at the transmission and reflection coefficient we find oscillations of them even though the energy is sufficent large $E / E_0 > 1$ in order to overcome the barrier. This behavior is completely analogous to a light wave beeing reflected at two parallel glass surfaces. We get the maximum transmission for $\\kappa \\cdot a = m \\cdot \\pi$, which gives a de Broglie wavelength of $\\lambda = 2a/m$ and a path difference of $\\Delta s = 2 a$. Thus, at the position $x = 0$ the wave being reflected at $x = a$ exhibits a phase difference relative to the wave being reflected right at $x = 0$ of $2 \\pi$. Since the wave being reflected at the potential wall (synonymously the medium with the higher refractive index) experiences a phase shift about $\\pi$, the reflected waves superimpose destructively within the whole region 1 resultin in $R = 0$. Thus, we get $T = 1$ in region 3. In constrast a path difference of $\\Delta s = \\left( 2m + 1 \\right) a$ results in constructive interference and a maximum of the $R$ and minimum of $T$."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
