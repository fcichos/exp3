{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "46387238-c31a-45d2-9e18-bec5d5201533",
   "metadata": {},
   "source": [
    "# The harmonic oscillator"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6aae02b1-641f-401e-9579-832141333d1a",
   "metadata": {},
   "source": [
    "One of the most important examples in all branches of physics is the harmonic oscillator. The potential has the shape of a parabola with the potential energy of \n",
    "\n",
    "$$\n",
    "E_{\\mathrm{pot}} = \\frac{1}{2} D x^2\n",
    "$$\n",
    "\n",
    "and the repelling force depends linearly on the deviation from the equilibrium position\n",
    "\n",
    "$$\n",
    "F = - \\mathrm{grad} \\left( E_{\\mathrm{pot}} \\right) = - D x  \\mathrm{.}\n",
    "$$\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L27_harmonic_oscillator.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: A particle within the parabolic potential of a harmonic oscillator.** \n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "In the case of classical mechanics we allready know examples like a weight at a  pendulum or a weight at a spring. We can treat the weight as a point-like mass $m$ oscillating around the rest position ($x = 0$) beeing reelled through the force $F = - D x$. The mass will then conduct a harmonic oscillation with the frequency \n",
    "\n",
    "$$\n",
    "\\omega = \\sqrt{\\frac{D}{m}} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "In order to discuss a quantum mechanic harmonic oscillator we start with the Schrödinger equation and the harmonic potential $E_{\\mathrm{pot}} = D x^2/2$,\n",
    "\n",
    "$$\n",
    "-\\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} \\psi \\left( x \\right) + \\frac{1}{2} D x^2 \\psi \\left( x \\right) = E \\psi \\left( x \\right) \\mathrm{,}\n",
    "$$\n",
    "\n",
    "which becomes \n",
    "\n",
    "$$\n",
    "-\\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} \\psi \\left( x \\right) + \\frac{1}{2} \\omega^2 m x^2 \\psi \\left( x \\right)  =  E \\psi \\left( x \\right)\n",
    "$$\n",
    "\n",
    "with the aid of the relation between the freuency $\\omega$ and the curvature of the potential $D$ and finally \n",
    "\n",
    "$$\n",
    "\\frac{\\partial^2}{\\partial x^2} \\psi \\left( x \\right) + \\left( \\frac{2 m}{\\hbar^2} E - \\frac{m^2 \\omega^2}{\\hbar^2} x^2 \\right) \\psi \\left( x \\right)  = 0 \\mathrm{.}\n",
    "$$\n",
    "\n",
    "Now we introduce the substitutions \n",
    "\n",
    "$$\n",
    "\\begin{eqnarray}\n",
    "x & = & \\sqrt{\\frac{\\hbar}{m \\omega}} \\cdot \\xi\\\\\n",
    "E & = & \\frac{\\hbar \\omega}{2} C\n",
    "\\end{eqnarray}\n",
    "$$\n",
    "\n",
    "and reformulate the Schrödinger equation like\n",
    "\n",
    "$$\n",
    "\\frac{\\partial^2}{\\partial \\xi^2} \\psi \\left( \\xi \\right) + \\left( C - \\xi^2 \\right) \\psi \\left( \\xi \\right)  = 0 \\mathrm{.}\n",
    "$$\n",
    "\n",
    "In the case of very high values of $\\xi$, the term $C$ can be neglected in comparison with the term $\\xi^2$. Thus, we can guess the solution $\\psi \\left( \\xi \\right)$ might behave like $\\propto \\mathrm{e}^{- \\frac{\\xi^2}{2}}$ in its asymptotic limit. The genernal solution reads as\n",
    "\n",
    "$$\n",
    "\\psi \\left( \\xi \\right) = H \\left( \\xi \\right) \\mathrm{e}^{- \\frac{\\xi^2}{2}} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "If we now use the general solution within the re-formed Schrödinger equation, we get \n",
    "\n",
    "$$\n",
    "\\frac{\\partial^2}{\\partial \\xi^2} H \\left( \\xi \\right) - 2 \\xi \\frac{\\partial}{\\partial \\xi} H \\left( \\xi \\right) + \\left( C - 1 \\right) H \\left( \\xi \\right)  = 0 \\mathrm{.}\n",
    "$$\n",
    "\n",
    "The very last equation is a second order ordinary differenctial equation, which has the shape of a **Hermite differential equation**. Its solutions are the **Hermite polynomials** of degree $n$  defined through\n",
    "\n",
    "$$\n",
    "H_n \\left( \\xi \\right) = \\left( -1 \\right)^{n} \\cdot \\mathrm{e}^{\\xi^2} \\cdot \\frac{\\partial^{n}}{\\partial \\xi^{n}} \\left( \\mathrm{e}^{- \\xi^2} \\right)\n",
    "$$\n",
    "\n",
    "with $n$ being natural number $n = 0,1,2,3, \\ldots$. If we test the Hermite polynomials in our function $H_{n} \\left( \\xi \\right)$, we will get\n",
    "\n",
    "$$\n",
    "C -1 = 2 n \\mathrm{.}\n",
    "$$\n",
    "\n",
    "The first four Hermite polynomials $H_n \\left( \\xi \\right)$ and the according wave functions $\\psi_n \\left( \\xi \\right)$ are listed in the following table. \n",
    "\n",
    " $n$ | $E_n$ | $H_{n} \\left( \\xi \\right)$ | $\\psi_{n} \\left( \\xi \\right)$ \n",
    "-----|-----|-----|----\n",
    " 0 | $\\frac{1}{2} \\hbar \\omega$ | $1$ | $N_0 \\cdot \\mathrm{-\\frac{\\xi^2}{2}}$ \n",
    " 1 | $\\frac{3}{2} \\hbar \\omega$ | $2 \\xi$ |$N_1 \\cdot 2\\xi \\cdot \\mathrm{-\\frac{\\xi^2}{2}}$ \n",
    " 2 | $\\frac{5}{2} \\hbar \\omega$ | $4 \\xi^2 -2$ | $N_2 \\cdot \\left(4\\xi^2-2\\right) \\cdot \\mathrm{-\\frac{\\xi^2}{2}}$ \n",
    " 3 | $\\frac{7}{2} \\hbar \\omega$ | $8 \\xi^3 -12\\xi$ | $N_3 \\cdot \\left(8\\xi-12\\xi\\right) \\cdot \\mathrm{-\\frac{\\xi^2}{2}}$ \n",
    "\n",
    "In addition, the normalization factors $N_n \\left( \\xi \\right)$ are indictaed which we have to chose in accord to the normalization condiction.\n",
    "\n",
    "$$\n",
    "\\int_{x = -\\infty}^{+\\infty} \\left| \\psi_n \\left( x \\right) \\right|^2 \\mathrm{d}x = 1\n",
    "$$\n",
    "\n",
    "We can reformulate the Hermite polynomials through a power series expansion \n",
    "\n",
    "$$\n",
    "H_n \\left( \\xi \\right) = \\sum_{k = 0}^{n} a_k \\cdot \\mathrm{e}^{k} \\mathrm{.}\n",
    "$$\n",
    "\n",
    "This series has to be *finite*, since otherwise $H_n \\left( \\xi \\right)$ will approach $+\\infty$ for $\\xi > 1$ and \n",
    "\n",
    "$$\n",
    "\\psi_n \\left( x \\right) = \\tilde{H}_n \\left( x \\right) \\mathrm{e}^{-\\frac{m E}{\\hbar^2} \\frac{x^2}{2}}\n",
    "$$\n",
    "    \n",
    "cannot be normalized for all $x$. If we now use the formular for the series expansion of $H_n \\left( \\xi \\right)$ in the differential equation and sort by coefficients with equal power of $\\xi^k$, we obtain the *recursive* equation\n",
    "\n",
    "$$\n",
    "\\left( k+2 \\right) \\cdot \\left( k+1 \\right) \\cdot a_{k+2} = \\left[ 2k - \\left( C-1 \\right)\\right] \\cdot a_k \\mathrm{.}\n",
    "$$\n",
    "\n",
    "Because the series of $H_n \\left( \\xi \\right)$ has to be *finite*, we set $\\xi^n$ as the highest power of $\\xi^k$, which results in $a_{n+2} = 0$. As a consequence and since $a_n \\neq 0$, we can state\n",
    "\n",
    "$$\n",
    "2n - \\left( C-1 \\right) = 0\n",
    "$$\n",
    "\n",
    "wich results in \n",
    "\n",
    "$$\n",
    "n = \\frac{1}{2} \\left( C-1 \\right) \\mathrm{.}\n",
    "$$\n",
    "\n",
    "If we re-substitute $C=2E / \\left( \\hbar \\omega \\right)$ and isolate $E$, we obtain\n",
    "\n",
    "$$\n",
    "E = \\hbar \\omega \\left( n +\\frac{1}{2} \\right) = E_n\\mathrm{,}\n",
    "$$\n",
    "\n",
    "with $n = 0,1,2,3 \\ldots$. Thus, it is obvious that the energy eigenvalues $E_n$ are **quantized** and **equidistanct**. Furthermore, the lowest energy is **non-zero**, it is rather\n",
    "\n",
    "$$\n",
    "E_0 = \\frac{1}{2} \\hbar \\omega \\mathrm{.}\n",
    "$$\n",
    "\n",
    "Since the quantum number $n$ uniquely determines the energy of the oscillation, it is referred to as *oscillation quantum number*. The oscilating wave function finally reads as\n",
    "\n",
    "$$\n",
    "\\psi_n \\left( x \\right) = \\tilde{H}_n \\left( x \\right) \\cdot \\mathrm{e}^{-\\frac{m \\omega}{2 \\hbar} x^2}\n",
    "$$\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L27_harmonic_oscillator_waves.png\" width=\"45%\">\n",
    "      <img src=\"img/L27_harmonic_oscillator_squaredwaves.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: (left) Wave functions $\\psi_{\\mathrm{n}}$ positioned at the height corresponding to the equidistant energy eigenvalue $E_{\\mathrm{n}}$. (right) The according probability densities (squared wave functions). The postential is $V = 0.5 \\cdot x^2$.** \n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "<figure>\n",
    "      <img src=\"img/L27_harmonic_oscillator_energy.png\" width=\"45%\">\n",
    "  <figcaption>**Fig.: The energy eigenvalues $E_{\\mathrm{n}}$ in dependence of the oscillation quantum number $n$ on a linear scale. The postential is $V = 0.5 \\cdot x^2$.** \n",
    "  </figcaption>\n",
    "</figure>\n",
    "\n",
    "Concerning classical mechanics, the probability to find the \"classical\" oscillating particle within the interval $\\left[x;x+\\mathrm{d}x\\right]$ is given through\n",
    "\n",
    "$$\n",
    "P \\left( x \\right) =  \\frac{1}{T} \\mathrm{d}t = \\frac{1}{v\\left(x\\right)} \\mathrm{d}t \\mathrm{,}\n",
    "$$\n",
    "\n",
    "where $T=2\\pi / \\omega$ is the time for one full oscillation and $\\mathrm{d}t  = 1/v\\left( x \\right) \\cdot \\mathrm{d}x$ as the time interval the particle needs to cover the distance $\\mathrm{d}x$. Since the speed of the particle is $0$ at the reversal points, the probability to find the particle is heighest at these positions. \n",
    "\n",
    "At the state of lowets energy $E_0$ the discrepancy between quantum mechanics and classical mechanics is the biggest. The classical harmonic oscillator exhibits a minimum of the probability at the position at rest, because there the kinetic energy is teh biggest and so the velocity. The quantum mechanic harmonic osciullator, however, exhibits the maximum probability at this position.\n",
    "\n",
    "If we consider higher quantum numbers, the probability density $\\left| \\psi_n \\left( x \\right) \\right|^2$ rises at the turning points. Thus, for higher quantum numbers, the quantum mechanical harmonic oscillator resambles the results from classical mechanics."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
