{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Multiple Wave Interference"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "So far we looked at the interference of two waves, which was a simplification as I mentioned already earlier. Commonly there will be a multitude of partial waves contribute to the oberved intereference. This is what we would like to have a look at now. We will do that in a quite general fashion, as the resulting formulas will appear several times again for different problems. \n",
    "\n",
    "Nevertheless we will make a difference between\n",
    "\n",
    "- multiwave interference of waves with the same amplitude\n",
    "- multiwave interference of waves with decreasing amplitude\n",
    "\n",
    "Especially the latter is often occuring, if we have multiple reflections and each reflection is only a fraction of the incident amplitude.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Multiple Wave Interference with Constant Amplitude"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the case of constant amplitude (for example realized by a grating, which we talk about later), the total wave amplitude is given according to the picture below by\n",
    "\n",
    "$$\n",
    "U=U_1+U_2+U_1+U_3+\\ldots+U_M\n",
    "$$\n",
    "\n",
    "where we sum the amplitude over $M$ partial waves. Between the neighboring waves (e.g. $U_1$ and $U_2$), we will assume a phase difference (because of a path length difference for example), which we denote as $\\phi$.\n",
    "\n",
    "The amplitude of the p-th wave is then given by \n",
    "\n",
    "$$\n",
    "U_p=\\sqrt{I_0}e^{i(p-1)\\phi}\n",
    "$$\n",
    "\n",
    "with the index $p$ being an interger $p=1,2,\\ldots,M$, $h=e^{i\\phi}$ and $\\sqrt{I_0}$ as the amplitude of each individual wave. The total amplitude $U$ can be then expressed as\n",
    "\n",
    "$$\n",
    "U=\\sqrt{I_0}\\left (1+h+h^2+\\ldots +h^{M-1}\\right)\n",
    "$$\n",
    "\n",
    "which is a geometric sum. We can apply the sum formula for geometric sums to obtain\n",
    "\n",
    "$$\n",
    "U=\\sqrt{I_0}\\frac{1-h^M}{1-h}=\\sqrt{I_0}\\frac{1-e^{iM\\phi}}{1-e^{i\\phi}}\n",
    "$$\n",
    "\n",
    "We now have to calculate the intensity of the total amplitude\n",
    "\n",
    "$$\n",
    "I=|U|^2=I_{0}\\left | \\frac{e^{-iM\\phi/2}-e^{iM\\phi/2}}{e^{-i\\phi/2}-e^{i\\phi/2}}\\right |^2\n",
    "$$\n",
    "\n",
    "which we can further simplify to give\n",
    "\n",
    "$$\n",
    "I=I_{0}\\frac{\\sin^2(M\\phi/2)}{\\sin^2(\\phi/2)}\n",
    "$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "|<img src=\"img/multi_wave.png\" width=\"90%\">|\n",
    "|-|\n",
    "| **Fig.:** Multiple wave interefence. Left: Phase construction of a multiwave intereference with M equal amplitude waves. Middle: Intensity distribution obtained as a function of the phase shift $\\phi$. Right: Examplary sketch of the interference generation.|"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The result is therefore an oscillating function. The numerator $\\sin^2(M\\phi/2)$ shows and oscillation frequency, which is by a factor of $M$ higher than the one in the denominator $\\sin^2\\phi/2)$. Special situations occur, whenever the numerator and the denominator become zero. This will happen whenever \n",
    "\n",
    "$$\n",
    "\\phi=m 2\\pi \n",
    "$$\n",
    "\n",
    "where $m$ is an integer and denotes the interference order, i.e. the number of wavelength that neighboring partial waves have as path length difference.\n",
    "In this case, the intensity distributiion will give us\n",
    "\n",
    "$$\n",
    "I=I_0 \\frac{0}{0}\n",
    "$$\n",
    "\n",
    "and we have to determine the limit with the help of l'Hospitals rule. The outcome of this calculation is, that \n",
    "\n",
    "$$\n",
    "I(\\phi=m2\\pi)=M^2 I_0\n",
    "$$\n",
    "\n",
    "which can be also realized when using the small angle approximation for the sine functions.\n",
    "\n",
    "Since he numerator is much faster oscillating then the denominator, we may also encounter the situation, where the numerator is zero, but the denomintor is not. These situations result in the additional minima between the primary maxima. We will have exactly $M-1$ minima between the global maxima and $M-2$ primary maxima. We will come back to these details when we talk about the diffraction grating in the next section.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Multiple Wave Interference with Decreasing Amplitude"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will turn our attention now to a slight modification of the previous multiwave interference. We will introduce a decreasing amplitude of the individual waves. The first wave shall have an amplitude $U_1=\\sqrt{I_0}$. The next wave, however, will not only be phase shifted but also have a smaller amplitude.\n",
    "\n",
    "\n",
    "$$\n",
    "U_2=h U_1\n",
    "$$\n",
    "\n",
    "where $h=re^{i\\phi}$ with $|h|=r<1$. $r$ can be regarded as a reflection coefficient, which deminishes the amplitude of the incident wave. According to that the intensity is reduced by \n",
    "\n",
    "$$\n",
    "I_2=|U_2|^2=|h U_1|^2=r^2 I_1\n",
    "$$\n",
    "\n",
    "The intensity of the incident wave is multiplied by a  factor $r^2$, while the amplitude is multiplied by $r$. Note that the phase factor $e^{i\\phi}$ is removed when taking the square of this complex number. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**Intensity at Boundaries**\n",
    "    \n",
    "The amplitude of the reflected wave is diminished by a factor \n",
    "$r\\le 1$, which is called the reflection coefficient. The intensity is diminished by a factor $R=|r|^2\\le1$, which is the **reflectance**.\n",
    "    \n",
    "In the absence of absorption, reflectance $R$  and **transmittance** $T$ add to one due to energy conservation. \n",
    "    \n",
    "$$\n",
    "R+T=1\n",
    "$$\n",
    "    \n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Consequently, the third wave would be now $U_3=hU_2=h^2U_1$.\n",
    "The total amplitude is thus \n",
    "\n",
    "$$\n",
    "U=U_1+U_2+U_3+\\ldots+U_M = \\sqrt{I_0}(1+h+h^2+\\ldots)\n",
    "$$\n",
    "\n",
    "|<img src=\"img/multi_wave_decreasing.png\" width=\"70%\">|\n",
    "|-|\n",
    "| **Fig.:** Multiple wave interefence with decreasing amplitudes. Left: Phase construction of a multiwave intereference with M equal amplitude waves. Right: Intensity distribution obtained as a function of the phase shift $\\phi$. |\n",
    "\n",
    "This yields again\n",
    "\n",
    "$$\n",
    "U=\\sqrt{I_0}\\frac{(1-h^M)}{1-h}=\\frac{\\sqrt{I_0}}{1-r e^{i\\phi}}\n",
    "$$\n",
    "\n",
    "Calculating the intensity of the waves is giving\n",
    "\n",
    "$$\n",
    "I=|U|^2=\\frac{I_{0}}{|1-re^{i\\phi}|^2}=\\frac{I_0}{(1-r)^2+4r\\sin^2(\\phi/2)}\n",
    "$$\n",
    "\n",
    "which is also known as the **Airy function**. This function can be further simplified by the following abbrevations\n",
    "\n",
    "$$\n",
    "I_{\\rm max}=\\frac{I_0}{(1-r)^2}\n",
    "$$\n",
    "\n",
    "and \n",
    "\n",
    "$$\n",
    "\\mathcal{F}=\\frac{\\pi \\sqrt{r}}{1-r}\n",
    "$$\n",
    "\n",
    "where the latter is called the *Finesse*. With those abbrevations, we obtain\n",
    "\n",
    "$$\n",
    "I=\\frac{I_{\\rm max}}{1+4\\left(\\frac{\\mathcal{F}}{\\pi}\\right)\\sin^{2}(\\phi/2)}\n",
    "$$\n",
    "\n",
    "for the interference of multiple waves with decreasing amplitude. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This intensity distribution has a different shape than the one we obtained for multiple waves with the same amplitude."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "|<img src=\"img/perot.png\" width=\"60%\">|\n",
    "|-|\n",
    "| **Fig.:** Multiple wave interference with decreasing amplitude. The graph shows the intensity distribution over the phase angle $\\phi$ for different values of the Finesse $\\mathcal{F}$.|"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We clearly observe that with increasing Finesse the intensity maxima, which occur at multiples fo $\\pi$ get much narrower. In addition the regions between the maxima show better contrast and fopr higher Finesse we get complete destructive interference. "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  },
  "toc-autonumbering": false,
  "toc-showmarkdowntxt": false,
  "toc-showtags": false,
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {},
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
