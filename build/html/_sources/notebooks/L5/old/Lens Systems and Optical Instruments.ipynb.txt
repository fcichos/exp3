{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Lens Systems and Optical Instruments"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Lens Systems"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Most of the optical instruments consist of multiple lenses that are used to image objects or to magnify them. They are combined at distances, which are either larger or smaller than the sum of their focal distances. The image below shows, for example, an artifical image of a lens system contained in a single microscope objctive lens, where you see multiple elements, e.g., doublets and triplets of lenses. These elements as joined objects may considerably improve the performance of the optics, e.g., correct for imaging errors. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "|<img src=\"img/objective_lens.jpg\" width=\"60%\">|\n",
    "|-|\n",
    "| **Fig.:** System of of lenses inside a microscope objective lens.|\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We will consider first a pair of two biconvex lenses that are at a distance $D>f_1+f_2$, where $f_1$ and $f_2$ are their focal distances. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "|<img src=\"img/lens_system.png\" width=\"60%\">|\n",
    "|-|\n",
    "| **Fig.:** System of two biconvex lenses at a distance larger than the sum of their focal distances.|"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here the first lens creates an image at a position\n",
    "\n",
    "$$b_1=\\frac{a_1 f_1}{(a_1-f_1)}.$$\n",
    "\n",
    "Accordingly the object distance for lens 2 is then $a_2=D-b_1$.\n",
    "\n",
    "The second lens then images this intermediate object into\n",
    "\n",
    "$$b_2=\\frac{a_2 f_2}{a_2-f_2}=\\frac{(D-b_1) f_2}{D-b_1-f_2},$$\n",
    "\n",
    "from which we can finally calculate the image location and also the size with the help of $b_1$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Instead of doing a lengthy transformation I would like to draw your attention to a simple method which arises from the linearization of Snell's law. This is called **matrix optics**. Matrix optics relates the outgoing angle $\\theta_2$ and height $y_2$ of an optical element to its incident angle $\\theta_1$ and $y_1$ via a matrix operation. Let us have a look at an example of a biconvex lens with a focal length $f$. An incident ray is then expressed by a vector \n",
    "\n",
    "$$\\begin{bmatrix}\n",
    "y_1\\\\\n",
    "\\theta_1\n",
    "\\end{bmatrix},$$\n",
    "\n",
    "which is converted by the lens into an outgoing ray vector\n",
    "\n",
    "$$\\begin{bmatrix}\n",
    "y_2\\\\\n",
    "\\theta_2\n",
    "\\end{bmatrix}.$$\n",
    "\n",
    "If you have two 2D vectors which you want to transform by a linear operation into each other, then the transformation can be described by a $2 \\times 2$ matrix, which is given for a lens with \n",
    "\n",
    "$$\\begin{bmatrix}\n",
    "A & B\\\\\n",
    "C & D\n",
    "\\end{bmatrix}\n",
    "=\n",
    "\\begin{bmatrix}\n",
    "1 & 0\\\\\n",
    "-\\frac{1}{f} & 1\n",
    "\\end{bmatrix}.\n",
    "$$\n",
    "\n",
    "Similarly we can also define a free space propagation matrix for a propagation by a distance $D$, which is\n",
    "\n",
    "$$\\begin{bmatrix}\n",
    "A & B\\\\\n",
    "C & D\n",
    "\\end{bmatrix}\n",
    "=\n",
    "\\begin{bmatrix}\n",
    "1 & D\\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}.\n",
    "$$\n",
    "\n",
    "The propagation of light through two lenses, which are seprarated by a distance $D$ is then the product of two matrices for the lenses and one for the free space. The transformation then in addition requires to multiply from the right side the incident vector and we obtain on the left side the outgoing ray vector.\n",
    "\n",
    "$$\\begin{bmatrix}\n",
    "y_2\\\\\n",
    "\\theta_2\\\\\n",
    "\\end{bmatrix}\n",
    "=\n",
    "\\begin{bmatrix}\n",
    "1 & 0\\\\\n",
    "-\\frac{1}{f_2} & 1 \\\\\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & D\\\\\n",
    "0 & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "1 & 0\\\\\n",
    "-\\frac{1}{f_1} & 1\n",
    "\\end{bmatrix}\n",
    "\\begin{bmatrix}\n",
    "y_1\\\\\n",
    "\\theta_1\n",
    "\\end{bmatrix}.$$\n",
    "\n",
    "If you multiply the $2 \\times 2$ matrices with each other, you will obtain a new $2 \\times 2$ matrix with a matrix element $C$, which should correspond to the effective focal length of that system. This is the case since the element $C=-\\frac{1}{f}$.\n",
    "\n",
    "The result of that calculation is \n",
    "\n",
    "$$\\frac{1}{f}=\\frac{1}{f_1}+\\frac{1}{f_2}-\\frac{D}{f_1 f_2},$$\n",
    "\n",
    "which gives the effective focal length of two biconvex lenses at a distance $D$."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Following this equation the inverse of the total focal length of the combined lenses is just the sum of its inverse focal distances minus a term, which depends on the distance of the two lenses. If this distance is small as compared to the focal length, i.e., the lenses are close to each other, the total inverse focal is just given by the first two terms. The inverse focal distances characterizes the refractive power of a lens. The larger the inverse value, the smaller is the focal distance. This refractive power is commonly measured in the unit **diopter**. One diopter corresponds to **1 dpt=1 $m^{-1}$**."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The image above shows also that in the case of the combined lenses and a real inverted intermediate image, the final image will be upright again.\n",
    "Thus, if the first lens has a magnification $M_1=-b_1/a_1$ and the second lens a magnification $M_2=-b_2/a_2$, the total magnification is the product, which is\n",
    "\n",
    "$$M=\\frac{b_1}{a_1}\\frac{b_2}{a_2},$$\n",
    "\n",
    "from which we may finally obtain with $M=\\frac{f}{f-a}$\n",
    "\n",
    "$$M=\\frac{1}{1-\\frac{a_1}{f_1}-\\frac{a_1+D}{f_2}+\\frac{a_1D}{f_1 f_2}}.$$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For more than two lenses, there is a versatile framework called **Matrix Optics**, which treats each optical element as a $2 \\times 2$ matrix. This becomes possible as we derived earlier equations which were linear in $y$ and $\\theta$. A whole system of different lenses, plates and other optical elements can, thus, be treated as a matrix multiplication, which is quite useful. "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
